{"ast":null,"code":"var path = require('path');\n\nmodule.exports = function (start, opts) {\n  var modules = opts.moduleDirectory ? [].concat(opts.moduleDirectory) : ['node_modules']; // ensure that `start` is an absolute path at this point,\n  // resolving against the process' current working directory\n\n  start = path.resolve(start);\n  var prefix = '/';\n\n  if (/^([A-Za-z]:)/.test(start)) {\n    prefix = '';\n  } else if (/^\\\\\\\\/.test(start)) {\n    prefix = '\\\\\\\\';\n  }\n\n  var splitRe = process.platform === 'win32' ? /[\\/\\\\]/ : /\\/+/;\n  var parts = start.split(splitRe);\n  var dirs = [];\n\n  for (var i = parts.length - 1; i >= 0; i--) {\n    if (modules.indexOf(parts[i]) !== -1) continue;\n    dirs = dirs.concat(modules.map(function (module_dir) {\n      return prefix + path.join(path.join.apply(path, parts.slice(0, i + 1)), module_dir);\n    }));\n  }\n\n  if (process.platform === 'win32') {\n    dirs[dirs.length - 1] = dirs[dirs.length - 1].replace(\":\", \":\\\\\");\n  }\n\n  return dirs.concat(opts.paths);\n};","map":null,"metadata":{},"sourceType":"script"}