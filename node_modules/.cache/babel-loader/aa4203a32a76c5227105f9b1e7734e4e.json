{"ast":null,"code":"var path = require('path');\n\nvar parse = path.parse || require('path-parse');\n\nvar getNodeModulesDirs = function getNodeModulesDirs(absoluteStart, modules) {\n  var prefix = '/';\n\n  if (/^([A-Za-z]:)/.test(absoluteStart)) {\n    prefix = '';\n  } else if (/^\\\\\\\\/.test(absoluteStart)) {\n    prefix = '\\\\\\\\';\n  }\n\n  var paths = [absoluteStart];\n  var parsed = parse(absoluteStart);\n\n  while (parsed.dir !== paths[paths.length - 1]) {\n    paths.push(parsed.dir);\n    parsed = parse(parsed.dir);\n  }\n\n  return paths.reduce(function (dirs, aPath) {\n    return dirs.concat(modules.map(function (moduleDir) {\n      return path.join(prefix, aPath, moduleDir);\n    }));\n  }, []);\n};\n\nmodule.exports = function nodeModulesPaths(start, opts, request) {\n  var modules = opts && opts.moduleDirectory ? [].concat(opts.moduleDirectory) : ['node_modules'];\n\n  if (opts && typeof opts.paths === 'function') {\n    return opts.paths(request, start, function () {\n      return getNodeModulesDirs(start, modules);\n    }, opts);\n  }\n\n  var dirs = getNodeModulesDirs(start, modules);\n  return opts && opts.paths ? dirs.concat(opts.paths) : dirs;\n};","map":null,"metadata":{},"sourceType":"script"}