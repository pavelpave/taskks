{"ast":null,"code":"/**\r\n * node-compress-commons\r\n *\r\n * Copyright (c) 2014 Chris Talkington, contributors.\r\n * Licensed under the MIT license.\r\n * https://github.com/archiverjs/node-compress-commons/blob/master/LICENSE-MIT\r\n */\nvar util = module.exports = {};\n\nutil.dateToDos = function (d, forceLocalTime) {\n  forceLocalTime = forceLocalTime || false;\n  var year = forceLocalTime ? d.getFullYear() : d.getUTCFullYear();\n\n  if (year < 1980) {\n    return 2162688; // 1980-1-1 00:00:00\n  } else if (year >= 2044) {\n    return 2141175677; // 2043-12-31 23:59:58\n  }\n\n  var val = {\n    year: year,\n    month: forceLocalTime ? d.getMonth() : d.getUTCMonth(),\n    date: forceLocalTime ? d.getDate() : d.getUTCDate(),\n    hours: forceLocalTime ? d.getHours() : d.getUTCHours(),\n    minutes: forceLocalTime ? d.getMinutes() : d.getUTCMinutes(),\n    seconds: forceLocalTime ? d.getSeconds() : d.getUTCSeconds()\n  };\n  return val.year - 1980 << 25 | val.month + 1 << 21 | val.date << 16 | val.hours << 11 | val.minutes << 5 | val.seconds / 2;\n};\n\nutil.dosToDate = function (dos) {\n  return new Date((dos >> 25 & 0x7f) + 1980, (dos >> 21 & 0x0f) - 1, dos >> 16 & 0x1f, dos >> 11 & 0x1f, dos >> 5 & 0x3f, (dos & 0x1f) << 1);\n};\n\nutil.fromDosTime = function (buf) {\n  return util.dosToDate(buf.readUInt32LE());\n};\n\nutil.getEightBytes = function (v) {\n  var buf = new Buffer(8);\n  buf.writeUInt32LE(v % 0x0100000000, 0);\n  buf.writeUInt32LE(v / 0x0100000000 | 0, 4);\n  return buf;\n};\n\nutil.getShortBytes = function (v) {\n  var buf = new Buffer(2);\n  buf.writeUInt16LE((v & 0xFFFF) >>> 0, 0);\n  return buf;\n};\n\nutil.getShortBytesValue = function (buf, offset) {\n  return buf.readUInt16LE(offset);\n};\n\nutil.getLongBytes = function (v) {\n  var buf = new Buffer(4);\n  buf.writeUInt32LE((v & 0xFFFFFFFF) >>> 0, 0);\n  return buf;\n};\n\nutil.getLongBytesValue = function (buf, offset) {\n  return buf.readUInt32LE(offset);\n};\n\nutil.toDosTime = function (d) {\n  return util.getLongBytes(util.dateToDos(d));\n};","map":null,"metadata":{},"sourceType":"script"}